<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>{{ room.TypeName }} – Details</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Open+Sans&display=swap" rel="stylesheet" />
</head>
<body>

  <!-- HEADER + NAVIGATION BAR -->
  {% include "partials/header_and_navbar.html" %}

  <!-- Flash Messages -->
  {% include "partials/success_flash_messages.html" %}
  {% include "partials/error_flash_messages.html" %}

  <main class="page-content">
    <section class="room-detail">
      <!-- Hero Image -->
      <div class="detail-hero">
        <img src="{{ url_for('static', filename=room.ImagePath) }}" alt="Room {{ room.RoomNumber }} – {{ room.TypeName }}">
        {% if room.ADAAccessible %}
          <span class="badge-ada">ADA</span>
        {% endif %}
      </div>

      <!-- Content columns -->
      <div class="detail-grid">
        <!-- Left column: info -->
        <article class="detail-info card">
          <h1 class="detail-title">{{ room.TypeName }}</h1>

          <ul class="detail-meta">
            <li><strong>Beds:</strong> {{ room.BedConfiguration }}</li>
            <li><strong>Price per Night:</strong> <span class="price">${{ '%.2f'|format(room.PricePerNight) }}</span></li>
            <li><strong>Max Occupancy:</strong> {{ room.MaxOccupancy }}</li>
            <li><strong>Accessible:</strong> {{ 'Yes' if room.ADAAccessible else 'No' }}</li>
          </ul>

          {% if room.Description %}
            <p class="detail-desc">{{ room.Description }}</p>
          {% endif %}

          {% if amenities and amenities|length %}
            <h3>Amenities</h3>
            <ul class="amenities-list">
              {% for a in amenities %}
                <li>{{ a.Name }}</li>
              {% endfor %}
            </ul>
          {% endif %}
        </article>

        <!-- Right column: booking box -->
        <aside class="detail-book card">
          <h2>Book this room</h2>
          <form method="POST" action="{{ url_for('room_details', room_id=room.RoomID) }}" class="booking-form">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

            <label class="form-row">
              <span>Check-in</span>
              <input type="date" name="check_in" required>
            </label>

            <label class="form-row">
              <span>Check-out</span>
              <input type="date" name="check_out" required>
            </label>

            <label class="form-row">
              <span>Guests (max {{ room.MaxOccupancy }})</span>
              <input type="number" name="guests" min="1" max="{{ room.MaxOccupancy }}" required>
            </label>

            <button type="submit" class="btn-brown full">Book Now</button>

            <p class="rate-note">
              <small>Rate: <strong>${{ '%.2f'|format(room.PricePerNight) }}</strong> per night</small>
            </p>
          </form>
        </aside>
      </div>
    </section>
  </main>

  <!-- FOOTER WITH PAGE LINKS -->
  {% include "partials/footer.html" %}

  <!-- LOGIN MODAL (Pop-up Overlay) -->
  {% include "partials/login_modal.html" %}

  <script>
    // Login Modal functionality
    const loginModal = document.getElementById('loginModal');
    const loginBtn = document.getElementById('loginBtn');
    const closeTriggers = document.querySelectorAll('[data-close-modal]');

    if (loginBtn) {
      loginBtn.addEventListener('click', () => {
        loginModal.classList.add('show');
      });
    }

    closeTriggers.forEach(el => {
      el.addEventListener('click', () => {
        loginModal.classList.remove('show');
      });
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === "Escape") {
        loginModal.classList.remove('show');
      }
    });
  </script>

  {% if show_login %}
  <script>
    window.onload = () => {
      const modal = document.getElementById('loginModal');
      if (modal) modal.classList.add('show');
    };
  </script>
  {% endif %}

</body>
</html>